---
sidebar: sidebar 
permalink: vmware/vmw-vcf-viwld-supp-nvme-network.html 
keywords: netapp, vmware, cloud, foundation, vcf, aff, all-flash, nfs, vvol, vvols, array, ontap tools, otv, sddc, iscsi 
summary: 'Configure a rede para armazenamento NVMe sobre TCP (NVMe/TCP) em hosts ESXi em um domínio de carga de trabalho VI.  Você criará grupos de portas distribuídas para tráfego NVMe, configurará adaptadores VMkernel em cada host ESXi e adicionará um adaptador NVMe/TCP para habilitar conectividade confiável e multipathing.' 
---
= Configurar rede para NVMe/TCP em hosts ESXi em um domínio de carga de trabalho VCF VI
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
Configure a rede para armazenamento NVMe sobre TCP (NVMe/TCP) em hosts ESXi em um domínio de carga de trabalho VI.  Você criará grupos de portas distribuídas para tráfego NVMe, configurará adaptadores VMkernel em cada host ESXi e adicionará um adaptador NVMe/TCP para habilitar conectividade confiável e multipathing.

Execute as seguintes etapas no cluster de domínio de carga de trabalho do VI usando o cliente vSphere. Neste caso, o vCenter Single Sign-On está sendo usado para que o cliente vSphere seja comum aos domínios de gerenciamento e de carga de trabalho.



== Etapa 1: criar grupos de portas distribuídas para tráfego NVME/TCP

Conclua as etapas a seguir para criar um novo grupo de portas distribuídas para cada rede NVMe/TCP.

.Passos
. No cliente vSphere, navegue até *Inventário > Rede* para o domínio de carga de trabalho.  Navegue até o Distributed Switch existente e escolha a ação para criar *Novo Grupo de Portas Distribuídas...*.
+
.Mostrar exemplo
[%collapsible]
====
image:vmware-vcf-asa-022.png["Escolha criar um novo grupo de portas"]

====
+
{nbsp}

. No assistente *Novo grupo de portas distribuídas*, preencha um nome para o novo grupo de portas e clique em *Avançar* para continuar.
. Na página *Configurar configurações*, preencha todas as configurações. Se VLANs estiverem sendo usadas, certifique-se de fornecer o ID de VLAN correto. Clique em *Avançar* para continuar.
+
.Mostrar exemplo
[%collapsible]
====
image:vmware-vcf-asa-023.png["Preencha o ID da VLAN"]

====
+
{nbsp}

. Na página *Pronto para concluir*, revise as alterações e clique em *Concluir* para criar o novo grupo de portas distribuídas.
. Repita esse processo para criar um grupo de portas distribuídas para a segunda rede NVMe/TCP que está sendo usada e certifique-se de ter inserido o *ID de VLAN* correto.
. Quando ambos os grupos de portas tiverem sido criados, navegue até o primeiro grupo de portas e selecione a ação *Editar configurações...*.
+
.Mostrar exemplo
[%collapsible]
====
image:vmware-vcf-asa-077.png["DPG - editar configurações"]

====
+
{nbsp}

. Na página *Grupo de portas distribuídas - Editar configurações*, navegue até *Agrupamento e failover* no menu à esquerda e clique em *uplink2* para movê-lo para *Uplinks não utilizados*.
+
.Mostrar exemplo
[%collapsible]
====
image:vmware-vcf-asa-078.png["mover uplink2 para não utilizado"]

====
. Repita esta etapa para o segundo grupo de portas NVMe/TCP. Desta vez, mova *uplink1* para *Uplinks não utilizados*.
+
.Mostrar exemplo
[%collapsible]
====
image:vmware-vcf-asa-079.png["mover uplink 1 para não utilizado"]

====




== Etapa 2: Crie os adaptadores VMkernel em cada host ESXi

Crie os adaptadores VMkernel em cada host ESXi no domínio de carga de trabalho.

.Passos
. No cliente vSphere, navegue até um dos hosts ESXi no inventário do domínio de carga de trabalho.  Na aba *Configurar* selecione *Adaptadores VMkernel* e clique em *Adicionar Rede...* para começar.
+
.Mostrar exemplo
[%collapsible]
====
image:vmware-vcf-asa-030.png["Iniciar assistente de adição de rede"]

====
. Na janela *Selecionar tipo de conexão*, escolha *Adaptador de rede VMkernel* e clique em *Avançar* para continuar.
+
.Mostrar exemplo
[%collapsible]
====
image:vmware-vcf-asa-008.png["Escolha o adaptador de rede VMkernel"]

====
. Na página *Selecionar dispositivo de destino*, escolha um dos grupos de portas distribuídas para iSCSI que foi criado anteriormente.
+
.Mostrar exemplo
[%collapsible]
====
image:vmware-vcf-asa-095.png["Escolha o grupo de portas de destino"]

====
. Na página *Propriedades da porta*, clique na caixa *NVMe/TCP* e clique em *Avançar* para continuar.
+
.Mostrar exemplo
[%collapsible]
====
image:vmware-vcf-asa-096.png["Propriedades da porta VMkernel"]

====
. Na página *Configurações IPv4*, preencha o *Endereço IP* e a *Máscara de sub-rede* e forneça um novo endereço IP de gateway (somente se necessário). Clique em *Avançar* para continuar.
+
.Mostrar exemplo
[%collapsible]
====
image:vmware-vcf-asa-097.png["Configurações IPv4 do VMkernel"]

====
. Revise suas seleções na página *Pronto para concluir* e clique em *Concluir* para criar o adaptador VMkernel.
+
.Mostrar exemplo
[%collapsible]
====
image:vmware-vcf-asa-098.png["Revisar as seleções do VMkernel"]

====
. Repita esse processo para criar um adaptador VMkernel para a segunda rede iSCSI.




== Etapa 3: adicionar adaptador NVMe/TCP

Cada host ESXi no cluster de domínio de carga de trabalho deve ter um adaptador de software NVMe/TCP instalado para cada rede NVMe/TCP estabelecida dedicada ao tráfego de armazenamento.

Para instalar adaptadores NVMe/TCP e descobrir os controladores NVMe, conclua as seguintes etapas.

. No cliente vSphere, navegue até um dos hosts ESXi no cluster de domínio de carga de trabalho.  Na guia *Configurar*, clique em *Adaptadores de armazenamento* no menu.
. No menu suspenso *Adicionar adaptador de software*, selecione *Adicionar adaptador NVMe sobre TCP*.
+
.Mostrar exemplo
[%collapsible]
====
image:vmware-vcf-asa-099.png["Adicionar adaptador NVMe/TCP"]

====
. Na janela *Adicionar adaptador de software NVMe sobre TCP*, acesse o menu suspenso *Adaptador de rede física* e selecione o adaptador de rede física correto no qual deseja habilitar o adaptador NVMe.
+
.Mostrar exemplo
[%collapsible]
====
image:vmware-vcf-asa-100.png["Selecione o adaptador físico"]

====
. Repita esse processo para a segunda rede atribuída ao tráfego NVMe/TCP, atribuindo o adaptador físico correto.
. Selecione um dos adaptadores NVMe/TCP recém-instalados.  Na aba *Controladores*, selecione *Adicionar Controlador*.
+
.Mostrar exemplo
[%collapsible]
====
image:vmware-vcf-asa-101.png["Adicionar controlador"]

====
. Na janela *Adicionar controlador*, selecione a aba *Automaticamente* e conclua as seguintes etapas.
+
.. Insira um endereço IP para uma das interfaces lógicas SVM na mesma rede que o adaptador físico atribuído a este adaptador NVMe/TCP.
.. Clique no botão *Descobrir controladores*.
.. Na lista de controladores descobertos, clique na caixa de seleção dos dois controladores com endereços de rede alinhados com este adaptador NVMe/TCP.


. Clique em *OK* para adicionar os controladores selecionados.
+
.Mostrar exemplo
[%collapsible]
====
image:vmware-vcf-asa-102.png["Descubra e adicione controladores"]

====
. Após alguns segundos, você deverá ver o namespace NVMe aparecer na guia Dispositivos.
+
.Mostrar exemplo
[%collapsible]
====
image:vmware-vcf-asa-103.png["Espaço de nome NVMe listado em dispositivos"]

====
. Repita este procedimento para criar um adaptador NVMe/TCP para a segunda rede estabelecida para tráfego NVMe/TCP.




== O que vem a seguir?

Após configurar a rede,link:vmw-vcf-viwld-supp-nvme-storage.html["configurar armazenamento para NVMe vVols"] .
