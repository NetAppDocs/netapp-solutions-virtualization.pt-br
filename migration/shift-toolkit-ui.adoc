---
sidebar: sidebar 
permalink: migration/shift-toolkit-ui.html 
keywords: netapp, vmware, esxi, vm, migration, openshift, virtualization, hyper-v, proxmox 
summary:  
---
= Configure o NetApp Shift Toolkit
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
Configure o Shift Toolkit para automatizar a migração ou conversão de VMs. Esse processo inclui adicionar sites de origem e destino, configurar armazenamento, agrupar VMs em grupos de recursos, criar projetos de migração e agendar migrações.



== Kit de ferramentas Run Shift

* Usando o navegador, acesse a interface do usuário do Shift Toolkit digitando o seguinte: `http://<IP address specified during installation>:3001`
+

NOTE: Use o Google Chrome ou o Internet Explorer para uma melhor experiência.

* Acesse a interface do usuário usando as credenciais padrão, conforme abaixo: Nome de usuário: admin Senha: admin
+
image::shift-toolkit-050.png[Diagrama da tela de login do NetApp Shift Toolkit]

+

NOTE: Os administradores precisam alterar suas credenciais durante o primeiro login.

+

NOTE: Após a alteração obrigatória da senha, as credenciais de administrador também podem ser alteradas usando a opção "Alterar Senha" após fazer login na interface gráfica.

+
image::shift-toolkit-051.png[Diagrama da tela de alteração de senha do NetApp Shift Toolkit]

+
Após concluir o processo, aceite o Contrato de Licença de Usuário Final (EULA) clicando em “Aceitar e Continuar”.

+
image::shift-toolkit-052.png[Captura de tela do Contrato de Licença de Usuário Final (EULA) da NetApp]





== Configuração do Shift Toolkit

Após configurar corretamente o armazenamento e a conectividade com os hipervisores de origem e destino, comece a configurar o Shift Toolkit para automatizar a migração ou conversão das máquinas virtuais para o formato apropriado, aproveitando a funcionalidade FlexClone .



=== Adicionar sites

O primeiro passo é descobrir e adicionar os detalhes do hipervisor de origem e, em seguida, do hipervisor de destino (tanto hipervisores quanto armazenamento) ao kit de ferramentas Shift.  Abra o Shift Toolkit em um navegador compatível, use o nome de usuário e a senha padrão e clique em “Adicionar Sites”.

image::shift-toolkit-053.png[Diálogo da caixa de diálogo Adicionar Sites do Shift Toolkit]


NOTE: Os sites também podem ser adicionados usando a opção Descobrir.

Adicione as seguintes plataformas:



==== Fonte

* Detalhes do site de origem
+
** Nome do site - Forneça um nome para o site
** Hipervisor – Selecione VMware ou Hyper-V como fonte.
** Localização do site – Selecione a opção padrão
** Conector – Selecione a seleção padrão




Depois de preenchido, clique em Continuar.

image::shift-toolkit-054.png[Diálogo da caixa de diálogo Adicionar Novo Site do Shift Toolkit]

* Se a opção selecionada for VMware, insira os detalhes do vCenter de origem.
+
** Ponto de extremidade - Insira o endereço IP ou FQDN do servidor vCenter
** Nome de usuário - nome de usuário para acessar o vCenter (no formato UPN: nomedeusuario@dominio.com)
** Senha do vCenter – Senha para acessar o vCenter para realizar o inventário dos recursos.
** Impressão digital SSL do vCenter (opcional)


* Se a opção selecionada for Hyper-V, insira os detalhes da origem Hyper-V.
+
** Ponto de extremidade - Insira o endereço IP ou o FQDN dos hosts independentes ou do ponto de extremidade do cluster de failover.
** Nome de usuário do Hyper-V - nome de usuário para acessar o Hyper-V (no formato de login de nível inferior (domínio\nome de usuário) ou UPN)
** Senha do Hyper-V – Senha para acessar o Hyper-V e realizar o inventário dos recursos.
+
 Select “Accept Self signed certificate” and click Continue.


* Credenciais do sistema de armazenamento ONTAP


image::shift-toolkit-055.png[Diálogo da caixa de diálogo Adicionar Novo Site do Shift Toolkit]

Uma vez adicionado, o Shift toolkit executará uma descoberta automática e exibirá as VMs junto com as informações de metadados relevantes. O Shift Toolkit detectará automaticamente as redes e VLANs usadas pelas VMs e as preencherá.


NOTE: Se alguma modificação for feita no site de origem, certifique-se de executar a descoberta para buscar as informações mais recentes. Isso pode ser feito clicando nos 3 pontos ao lado do nome do site e, em seguida, clicando em “Descobrir Site”.


NOTE: O inventário da VM é atualizado automaticamente a cada 24 horas.

image::shift-toolkit-056.png[Diálogo da caixa de diálogo Adicionar Novo Site do Shift Toolkit para descobrir um site]

Para visualizar os dados de descoberta de um hipervisor de origem específico, acesse o painel de controle e clique em "Exibir lista de VMs" ao lado do nome do site correspondente. A página exibirá o inventário da VM junto com os atributos da VM.

image::shift-toolkit-057.png[Diálogo do Shift Toolkit descobriu sites]

O próximo passo é adicionar o hipervisor de destino. Para adicionar, clique em “Adicionar novo site” e selecione “Destino”.



==== Destino

image::shift-toolkit-058.png[Diálogo de diálogo Adicionar Site do Shift Toolkit para o destino]

* Detalhes do local de destino
+
** Nome do site - Forneça um nome para o site
** Hipervisor – Selecione a plataforma de destino apropriada dentre as seguintes opções:
+
*** VMware
*** Hyper-V
*** OpenShift
*** OLVM
*** KVM (somente conversão)


** Localização do site – Selecione a opção padrão
** Conector – Selecione a seleção padrão




Depois de preenchido, clique em Continuar.

image::shift-toolkit-059.png[Diálogo da caixa de diálogo Adicionar Local do Shift Toolkit para os detalhes de destino.]

Com base na seleção do hipervisor, preencha os detalhes necessários.

* Detalhes do hipervisor de destino
+
** Endereço IP ou FQDN do endpoint do respectivo gerenciador de hipervisor
** Nome de usuário – nome de usuário para acesso (no formato UPN: nome de usuário@dominio.com ou domínio\administrador) Senha – Senha para acessar e realizar o inventário dos recursos.




Selecione “Aceitar certificado autoassinado”.

* Após concluir, clique em “Criar site”.



NOTE: O sistema de armazenamento de origem e destino deve ser o mesmo, pois a conversão do formato do disco ocorre no nível do volume e dentro do mesmo volume.

image::shift-toolkit-060.png[Diálogo da caixa de diálogo Adicionar Local do Shift Toolkit para os detalhes de destino.]

O próximo passo é agrupar as VMs necessárias em seus grupos de migração como grupos de recursos.



=== Agrupamentos de Recursos

Depois que as plataformas forem adicionadas, agrupe as VMs que você deseja migrar ou converter em grupos de recursos.  Os grupos de recursos do Shift Toolkit permitem que você agrupe conjuntos de VMs dependentes em grupos lógicos que contêm suas ordens de inicialização e atrasos de inicialização.


NOTE: Certifique-se de que os Qtrees estejam provisionados (conforme mencionado na seção de pré-requisitos) antes de criar os grupos de recursos.

Para começar a criar grupos de recursos, clique no item de menu “Criar novo grupo de recursos”.

. Para acessar os grupos de recursos, clique em “Criar novo grupo de recursos”.
+
image::shift-toolkit-061.png[Diálogo da interface de usuário Criar Novo Grupo de Recursos]

. Na janela “Novo grupo de recursos”, selecione o site de origem no menu suspenso e clique em “Criar”.
. Forneça detalhes do grupo de recursos e selecione o fluxo de trabalho.  O fluxo de trabalho oferece duas opções
+
.. Migração baseada em clone – executa a migração de ponta a ponta da VM do hipervisor de origem para o hipervisor de destino.
.. Conversão baseada em clone – executa a conversão do formato do disco para o tipo de hipervisor selecionado.
+
image::shift-toolkit-062.png[Diálogo da interface de usuário Criar Novo Grupo de Recursos]



. Clique em “Continuar”
. Selecione as VMs apropriadas usando a opção de pesquisa. A opção de filtro padrão é “Armazenamento de dados”.
+

NOTE: Mova as VMs para converter ou migrar para um armazenamento de dados designado em um SVM ONTAP recém-criado antes da conversão. Isso ajuda a isolar o armazenamento de dados NFS de produção e o armazenamento de dados designado pode ser usado para preparar as máquinas virtuais.

+

NOTE: Para o ambiente OpenShift, os VMDKs devem ser realocados para seus volumes correspondentes para replicar a estrutura do PVC (Persistent Volume Claim) usando o driver de armazenamento ONTAP NAS. Em versões futuras, serão incorporadas melhorias adicionais para aproveitar ao máximo o fator econômico do ONTAP NAS.

+
image::shift-toolkit-063.png[Diálogo da interface de usuário Criar Novo Grupo de Recursos]

+

NOTE: O menu suspenso de armazenamento de dados neste contexto mostrará apenas armazenamentos de dados NFSv3. Os armazenamentos de dados NFSv4 não serão exibidos.

+
image::shift-toolkit-064.png[Diálogo da interface de usuário Criar Novo Grupo de Recursos]

. Atualize os detalhes da migração selecionando “Site de destino”, “Entrada do hipervisor de destino” e “Mapeamento de armazenamento de dados para Qtree ou classe de armazenamento”.
+
image::shift-toolkit-065.png[Diálogo da interface de usuário Criar Novo Grupo de Recursos]

+

NOTE: Ao converter VMs, certifique-se de que o caminho de destino (onde as VMs convertidas são armazenadas) esteja definido como uma qtree. Defina o caminho de destino para a qtree apropriada.

+

NOTE: Várias qtrees podem ser criadas e usadas para armazenar os discos de VM convertidos adequadamente.

+

NOTE: As máquinas virtuais podem ser executadas em datastores distribuídos, e o Shit Toolkit as detectará automaticamente; no entanto, uma qtree deve ser mapeada para cada volume.

+
Capacidade de migrar VMs com VMDKs distribuídos em vários volumes. A interface do usuário do Shift Toolkit seleciona automaticamente todos os volumes distribuídos que fazem parte de uma ou mais VMs selecionadas para aquele grupo de recursos específico.  Esta seção listará todos os volumes na página RG onde realizamos o mapeamento de armazenamento de dados para qtree.

+
image::shift-toolkit-066.png[Diálogo da interface de usuário Criar Novo Grupo de Recursos]

. Selecione a Ordem de inicialização e o Atraso de inicialização (segs) para todas as VMs selecionadas. Defina a ordem de inicialização selecionando cada máquina virtual e definindo a prioridade para ela. 3 é o valor padrão para todas as máquinas virtuais. As opções são as seguintes: 1 – A primeira máquina virtual a ser ligada; 3 – Padrão; 5 – A última máquina virtual a ser ligada.
+
image::shift-toolkit-067.png[Diálogo da interface de usuário Criar Novo Grupo de Recursos]

. Clique em “Criar Grupo de Recursos”.
+
image::shift-toolkit-068.png[Diálogo da interface de usuário Criar Novo Grupo de Recursos]

+

NOTE: Caso seja necessário modificar o grupo de recursos para adicionar ou remover máquinas virtuais, utilize esta opção junto ao nome do grupo de recursos e selecione “Editar Grupo de Recursos”.





=== Projetos

Para migrar ou converter máquinas virtuais, é necessário um plano. Selecione as plataformas de hipervisor de origem e destino no menu suspenso e escolha os grupos de recursos a serem incluídos neste projeto, juntamente com o agrupamento de como os aplicativos devem ser ligados (por exemplo, controladores de domínio, depois nível 1, depois nível 2, etc.). Muitas vezes, eles também são chamados de planos de migração. Para definir o projeto, acesse a aba “Projetos” e clique em “Criar novo projeto”.

Para começar a criar um projeto, clique em “Criar novo projeto”.

. Para acessar os projetos, clique em “Criar novo projeto”.
+
image::shift-toolkit-069.png[Diálogo da interface de usuário do Access Blueprints]

. Na “Nova Planta”, forneça um nome para o plano e adicione os mapeamentos de host necessários selecionando Site de Origem > vCenter associado, Site de Destino e o hipervisor associado.
. Depois que os mapeamentos forem concluídos, selecione o mapeamento de cluster e host. No exemplo abaixo, o Hyper-V é mostrado como o destino.  A opção de hipervisor exibida varia de acordo com o site de origem selecionado.
+
image::shift-toolkit-070.png[Diálogo da interface de usuário Criar Novos Projetos]

. Selecione Detalhes do Grupo de Recursos e clique em “Continuar”.
+
image::shift-toolkit-071.png[Diálogo da interface de usuário Criar Novos Projetos]

. Definir ordem de execução para grupo de recursos.  Esta opção permite selecionar a sequência de operações quando existem vários grupos de recursos.
. Após concluir as etapas anteriores, selecione Mapeamento de Rede e atribua-o ao mapa de rede apropriado.  Certifique-se de que os switches virtuais, perfis de rede ou operadores já estejam provisionados no hipervisor de destino.
+
image::shift-toolkit-072.png[Diálogo da interface de usuário Criar Novos Projetos]

+

NOTE: Para migração de teste, a opção padrão é “Não configurar a rede” e o Shift Toolkit não realiza a atribuição de endereços IP. Após a conversão do disco e a aquisição da máquina virtual no respectivo hipervisor, atribua manualmente os switches de rede do ambiente de produção para evitar conflitos com a rede de produção.

+
image::shift-toolkit-073.png[Diálogo da interface de usuário Criar Novos Projetos]

. Com base na seleção de VMs, os mapeamentos de armazenamento serão selecionados automaticamente.
+

NOTE: Certifique-se de que a qtree esteja provisionada previamente e que as permissões necessárias estejam atribuídas para que a máquina virtual possa ser criada e ligada.  NOTA: No caso do OpenShift, os PVCs são criados usando o Trident CSI e não há necessidade de criar qtrees previamente.

. Em detalhes da VM, forneça a conta de serviço e credenciais de usuário válidas para cada tipo de sistema operacional.  Isso é usado para conectar-se à máquina virtual para criar e executar determinados scripts necessários para remover ferramentas VMware e fazer backup de detalhes de configuração de IP.
+
.. Para sistemas operacionais baseados em Windows, é recomendável usar um usuário com privilégios de administrador local. Credenciais de domínio também podem ser usadas, porém certifique-se de que exista um perfil de usuário na máquina virtual antes da conversão; caso contrário, as credenciais de domínio não funcionarão, pois o sistema buscará autenticação de domínio quando não houver conexão de rede.
.. No caso de máquinas virtuais convidadas baseadas em distribuições Linux, forneça um usuário que possa executar comandos sudo sem senha, o que significa que o usuário deve fazer parte da lista sudoers ou ser adicionado como um novo arquivo de configuração na pasta /etc/sudoers.d/.
+
image::shift-toolkit-074.png[Diálogo da interface de usuário Criar Novos Projetos]

+
Na versão mais recente, o Shift Toolkit introduziu maior flexibilidade na preparação de máquinas virtuais.  Por padrão, o conjunto de ferramentas automatiza a preparação da VM implantando scripts específicos do sistema operacional para: * Remover o VMware Tools * Fazer backup das configurações de IP para reatribuição com base no Blueprint selecionado

+
Com a nova melhoria, os usuários agora podem substituir as tarefas padrão de preparação da VM, permitindo a execução de scripts personalizados para preparação manual da VM, incluindo a atribuição de IP.  Isso proporciona maior controle para ambientes com requisitos de configuração ou conformidade específicos.



. Novamente em Detalhes da VM, selecione a opção de configuração de IP relevante. Por padrão, a opção “Não configurar” está selecionada.
+
.. Para migrar VMs com os mesmos IPs do sistema de origem, selecione “Manter IP”.
.. Para migrar máquinas virtuais usando IPs estáticos no sistema de origem e atribuir DHCP nas máquinas virtuais de destino, selecione “DHCP”.
+
Certifique-se de que os seguintes requisitos sejam atendidos para que esta funcionalidade funcione:

+
*** Certifique-se de que as VMs estejam ligadas durante a fase prepareVM e até o horário de migração agendado.
*** Para VMs VMware, certifique-se de que o VMware Tools esteja instalado.
*** Para o Hyper-V como hipervisor de origem, certifique-se de que os Serviços de Integração estejam habilitados e configurados.
*** Para OLVM e OpenShift como hipervisores de destino, certifique-se de montar o arquivo ISO do virtIO nas VMs do Windows.
*** Certifique-se de que o script de preparação seja executado na máquina virtual de origem por uma conta com privilégios de administrador no sistema operacional Windows e com privilégios sudo, sem a opção de senha, em sistemas operacionais baseados em Linux, para criar tarefas cron.




. O próximo passo é a configuração da VM.
+
** Opcionalmente, redimensione os parâmetros de CPU/RAM das VMs, o que pode ser muito útil para fins de redimensionamento.
** Substituição da ordem de inicialização: modifique também a ordem de inicialização e o atraso de inicialização (s) para todas as VMs selecionadas nos grupos de recursos.  Esta é uma opção adicional para modificar a ordem de inicialização caso sejam necessárias alterações em relação ao que foi selecionado durante a seleção da ordem de inicialização do grupo de recursos.  Por padrão, a ordem de inicialização selecionada durante a seleção do grupo de recursos é usada, no entanto, quaisquer modificações podem ser feitas nesta fase.
** Ligar: desmarque esta opção se o fluxo de trabalho não quiser ligar a máquina virtual.  A opção padrão é LIGADO, o que significa que a VM será LIGADA.
** Remover ferramentas VMware: o Shift toolkit remove as ferramentas VMware após a conversão. Esta opção é selecionada por padrão. Esta opção deve ser desmarcada se o plano for executar scripts personalizados do cliente.
** Geração: O Shift toolkit usa a seguinte regra prática e o padrão é o apropriado: Gen1 > BIOS e Gen2 > EFI.  Nenhuma seleção é possível para esta opção.
** Manter MAC: o endereço MAC das respectivas VMs pode ser retido para superar os desafios de licenciamento dos aplicativos que dependem do MAC.
** Substituição de conta de serviço: esta opção permite especificar uma conta de serviço separada se a global não puder ser usada.
+
image::shift-toolkit-075.png[Diálogo da interface do usuário do Grupo de Recursos]



. Clique em “Continuar”.
. Na próxima etapa, agende a migração marcando a caixa de seleção para definir a data e a hora. Certifique-se de que todas as máquinas virtuais (VMs) estejam preparadas e desligadas antes da data agendada. Após concluir, clique em “Criar Projeto”.
+
image::shift-toolkit-076.png[Diálogo da interface do usuário do Grupo de Recursos]

+

NOTE: Ao agendar, escolha uma data que esteja pelo menos 30 minutos à frente do horário atual do Shift VM. Isso garante que o fluxo de trabalho tenha tempo suficiente para preparar as VMs dentro do grupo de recursos.

. Depois que o blueprint é criado, um trabalho prepareVM é iniciado e executa automaticamente scripts nas VMs de origem para prepará-las para migração
+
image::shift-toolkit-077.png[Diálogo da interface do usuário do Grupo de Recursos]

+
Este trabalho executa um script usando o método invoke-VMScript para copiar os scripts necessários para remover as ferramentas VMware e fazer backup dos detalhes de configuração de rede, incluindo endereço IP, rotas e informações de DNS, que serão usados para manter as mesmas configurações na VM de destino.

+
.. Para sistemas operacionais baseados em Windows, o local padrão onde os scripts de preparação são armazenados é a pasta “C:\ NetApp”.
+
image::shift-toolkit-078.png[Diálogo da interface do usuário do Grupo de Recursos]

.. Para VMs baseadas em Linux, o local padrão onde os scripts de preparação são armazenados é / NetApp e o diretório /opt.
+
image::shift-toolkit-079.png[Diálogo da interface do usuário do Grupo de Recursos]

+

NOTE: Para uma VM de origem Linux executando CentOS ou Red Hat, o Shift toolkit é inteligente para instalar automaticamente os drivers Hyper-V necessários. Esses drivers devem estar presentes na VM de origem antes da conversão do disco para garantir que a VM possa inicializar com sucesso após a conversão.

+

NOTE: Para obter informações detalhadas, consultelink:https://access.redhat.com/solutions/3465011["Sistema travado no dracut após a migração de uma VM RHEL para o hyper-v"] .

+
Assim que o trabalho prepareVM for concluído com sucesso (conforme mostrado na captura de tela abaixo), as VMs estarão prontas para migração, e o status do blueprint será atualizado para "Ativo".

+
image::shift-toolkit-080.png[Diálogo da interface do usuário do Grupo de Recursos]

+
image::shift-toolkit-081.png[Diálogo da interface do usuário do Grupo de Recursos]

+
A migração agora ocorrerá no horário definido ou pode ser iniciada manualmente clicando na opção Migrar.




